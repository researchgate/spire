language: node_js
node_js:
  - 8
  - 10
  - 12
  - 13
cache: yarn
jobs:
  include:
    - stage: test
      script:
        - yarn lint
        - yarn test
    - stage: prerelease
      node_js: 12
      before_install:
        - curl -o- -L https://yarnpkg.com/install.sh | bash
        - export PATH="$HOME/.yarn/bin:$PATH"
      if: (NOT type IN (pull_request)) AND (branch = master)
      script:
        - echo "//registry.npmjs.org/:_authToken=${NPM_TOKEN}" > .npmrc
        - yarn pre-release
